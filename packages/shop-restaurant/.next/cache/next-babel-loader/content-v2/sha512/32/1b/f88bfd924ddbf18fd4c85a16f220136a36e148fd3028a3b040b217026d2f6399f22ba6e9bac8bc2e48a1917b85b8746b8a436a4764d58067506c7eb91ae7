{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"/Users/alejandrosandoval/space/world_eserp/web/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/alejandrosandoval/space/world_eserp/web/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/alejandrosandoval/space/world_eserp/web/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"/Users/alejandrosandoval/space/world_eserp/web/packages/shop-restaurant/src/layouts/header/menu/authorized-menu.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport NavLink from 'components/nav-link/nav-link';\nimport { AUTHORIZED_MENU_ITEMS } from 'site-settings/site-navigation';\nimport { useCart } from 'contexts/cart/use-cart';\nimport Cookies from 'universal-cookie';\nimport { AuthContext } from 'contexts/auth/auth.context';\nimport Router from 'next/router';\nimport localForage from 'localforage';\nimport { useMutation, useQuery } from '@apollo/client';\nimport { GET_ABANDONADOS } from 'utils/graphql/query/abandonados.query';\nimport { AGREGAR_ABANDONADO } from 'utils/graphql/mutation/abandonados';\nimport { UPGRADE_ABANDONADO } from 'utils/graphql/mutation/abandonados';\nexport var AuthorizedMenu = function AuthorizedMenu(_ref) {\n  _s();\n\n  var onLogout = _ref.onLogout;\n  var cookie = new Cookies();\n  var cid = cookie.get('cid');\n\n  var _useContext = useContext(AuthContext),\n      authDispatch = _useContext.authDispatch;\n\n  var _useState = useState(''),\n      carrito = _useState[0],\n      setCarrito = _useState[1];\n\n  var _useMutation = useMutation(AGREGAR_ABANDONADO),\n      _useMutation2 = _slicedToArray(_useMutation, 1),\n      insert_abandonado = _useMutation2[0];\n\n  var _useMutation3 = useMutation(UPGRADE_ABANDONADO),\n      _useMutation4 = _slicedToArray(_useMutation3, 1),\n      upgrade_abandonado = _useMutation4[0];\n\n  var _useQuery = useQuery(GET_ABANDONADOS, {\n    variables: {\n      clientid: cid,\n      customerid: cookie.get('customer') && cookie.get('customer').id\n    }\n  }),\n      data = _useQuery.data;\n\n  var _useCart = useCart(),\n      clearCart = _useCart.clearCart;\n\n  var init = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var keys;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (!localForage) {\n                _context2.next = 6;\n                break;\n              }\n\n              _context2.next = 3;\n              return localForage.keys();\n\n            case 3:\n              keys = _context2.sent;\n              console.log('key', keys);\n              return _context2.abrupt(\"return\", Promise.all(keys.map( /*#__PURE__*/function () {\n                var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(key) {\n                  return _regeneratorRuntime.wrap(function _callee$(_context) {\n                    while (1) {\n                      switch (_context.prev = _context.next) {\n                        case 0:\n                          if (!(key === '@session')) {\n                            _context.next = 11;\n                            break;\n                          }\n\n                          _context.t0 = console;\n                          _context.next = 4;\n                          return localForage.getItem(key);\n\n                        case 4:\n                          _context.t1 = _context.sent;\n\n                          _context.t0.log.call(_context.t0, '|||||', _context.t1);\n\n                          _context.t2 = setCarrito;\n                          _context.next = 9;\n                          return localForage.getItem(key);\n\n                        case 9:\n                          _context.t3 = _context.sent;\n                          (0, _context.t2)(_context.t3);\n\n                        case 11:\n                        case \"end\":\n                          return _context.stop();\n                      }\n                    }\n                  }, _callee);\n                }));\n\n                return function (_x) {\n                  return _ref3.apply(this, arguments);\n                };\n              }())));\n\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function init() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    init();\n  });\n\n  function deleteAllCookies() {\n    var cookies = document.cookie.split(\";\");\n\n    for (var i = 0; i < cookies.length; i++) {\n      var cookie = cookies[i];\n      var eqPos = cookie.indexOf(\"=\");\n      var name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;\n      document.cookie = name + \"=;expires=Thu, 01 Jan 1970 00:00:00 GMT\";\n    }\n  }\n\n  var push = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              console.log('push!', carrito);\n\n              if (!(carrito !== '' && carrito !== '{\\\"isOpen\\\":false,\\\"items\\\":[],\\\"isRestaurant\\\":false,\\\"coupon\\\":null}')) {\n                _context3.next = 4;\n                break;\n              }\n\n              _context3.next = 4;\n              return insert_abandonado({\n                variables: {\n                  clientid: config().SUBSCRIPTION_ID,\n                  customerid: cookie.get('customer') && cookie.get('customer').id,\n                  data_json: carrito\n                }\n              });\n\n            case 4:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function push() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var put = /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              if (!(carrito !== '' && carrito !== '{\\\"isOpen\\\":false,\\\"items\\\":[],\\\"isRestaurant\\\":false,\\\"coupon\\\":null}')) {\n                _context4.next = 3;\n                break;\n              }\n\n              _context4.next = 3;\n              return upgrade_abandonado({\n                variables: {\n                  \"clientid\": config().SUBSCRIPTION_ID,\n                  \"customerid\": cookie.get('customer') && cookie.get('customer').id,\n                  \"data_json\": carrito\n                }\n              });\n\n            case 3:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function put() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  var handleLogout = /*#__PURE__*/function () {\n    var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              if (!(data && data.carritos_abandonados && data.carritos_abandonados.length > 0)) {\n                _context5.next = 3;\n                break;\n              }\n\n              _context5.next = 3;\n              return put();\n\n            case 3:\n              if (!(data && data.carritos_abandonados && data.carritos_abandonados.length === 0)) {\n                _context5.next = 6;\n                break;\n              }\n\n              _context5.next = 6;\n              return push();\n\n            case 6:\n              _context5.next = 8;\n              return cookie.remove('access_token');\n\n            case 8:\n              _context5.next = 10;\n              return cookie.remove('customer');\n\n            case 10:\n              _context5.next = 12;\n              return cookie.remove('user_logged');\n\n            case 12:\n              localForage.removeItem('@session');\n              _context5.next = 15;\n              return deleteAllCookies();\n\n            case 15:\n              _context5.next = 17;\n              return clearCart();\n\n            case 17:\n              authDispatch({\n                type: 'SIGN_OUT'\n              });\n              Router.push('/grocery');\n\n            case 19:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    return function handleLogout() {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [AUTHORIZED_MENU_ITEMS.map(function (item, idx) {\n      return /*#__PURE__*/_jsxDEV(NavLink, {\n        className: \"menu-item\",\n        href: item.href,\n        label: item.defaultMessage,\n        intlId: item.id\n      }, idx, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 9\n      }, _this);\n    }), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"menu-item\",\n      onClick: handleLogout,\n      children: /*#__PURE__*/_jsxDEV(\"a\", {\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          children: /*#__PURE__*/_jsxDEV(FormattedMessage, {\n            id: \"nav.logout\",\n            defaultMessage: \"Logout\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 140,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 11\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true);\n};\n\n_s(AuthorizedMenu, \"Y/zMeS3z5kMKLWfNvIbg2MPKSNw=\", false, function () {\n  return [useMutation, useMutation, useQuery, useCart];\n});\n\n_c = AuthorizedMenu;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthorizedMenu\");","map":{"version":3,"sources":["/Users/alejandrosandoval/space/world_eserp/web/packages/shop-restaurant/src/layouts/header/menu/authorized-menu.tsx"],"names":["React","useContext","useEffect","useState","FormattedMessage","NavLink","AUTHORIZED_MENU_ITEMS","useCart","Cookies","AuthContext","Router","localForage","useMutation","useQuery","GET_ABANDONADOS","AGREGAR_ABANDONADO","UPGRADE_ABANDONADO","AuthorizedMenu","onLogout","cookie","cid","get","authDispatch","carrito","setCarrito","insert_abandonado","upgrade_abandonado","variables","clientid","customerid","id","data","clearCart","init","keys","console","log","Promise","all","map","key","getItem","deleteAllCookies","cookies","document","split","i","length","eqPos","indexOf","name","substr","push","config","SUBSCRIPTION_ID","data_json","put","handleLogout","carritos_abandonados","remove","removeItem","type","item","idx","href","defaultMessage"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport NavLink from 'components/nav-link/nav-link';\nimport { AUTHORIZED_MENU_ITEMS } from 'site-settings/site-navigation';\nimport { useCart } from 'contexts/cart/use-cart';\nimport Cookies  from 'universal-cookie';\nimport { AuthContext } from 'contexts/auth/auth.context';\nimport Router from 'next/router';\nimport localForage from 'localforage'; \nimport { useMutation, useQuery } from '@apollo/client';\nimport { GET_ABANDONADOS } from 'utils/graphql/query/abandonados.query';\nimport { AGREGAR_ABANDONADO } from 'utils/graphql/mutation/abandonados';\nimport { UPGRADE_ABANDONADO } from 'utils/graphql/mutation/abandonados';\n\ntype Props = {\n  onLogout: () => void;\n};\n\n\nexport const AuthorizedMenu: React.FC<Props> = ({ onLogout }) => {\n\n  const cookie = new Cookies()\n  const cid = cookie.get('cid')\n  const { authDispatch } = useContext<any>(AuthContext);\n  var [carrito, setCarrito] = useState('');\n\n  const [insert_abandonado] = useMutation(AGREGAR_ABANDONADO); \n  const [upgrade_abandonado] = useMutation(UPGRADE_ABANDONADO); \n\n  const { data } = useQuery(\n    GET_ABANDONADOS,\n    {\n      variables: { \n        clientid: cid,\n        customerid: cookie.get('customer') &&  cookie.get('customer').id\n      }\n    }\n  );\n\n  const { \n    clearCart,\n  } = useCart();\n\n  const init = async ()=> {\n    if (localForage) {\n      var keys = await localForage.keys()\n      console.log('key',keys)\n      return Promise.all(keys.map(async key => {\n        if(key==='@session'){\n          console.log('|||||', await localForage.getItem(key))\n          setCarrito(await localForage.getItem(key))\n        }  \n      }))\n     }\n  }\n\n\n  useEffect(() => {\n     init()\n  })\n\n\n  function deleteAllCookies() {\n  \n    var cookies = document.cookie.split(\";\");\n  \n    for (var i = 0; i < cookies.length; i++) {\n        var cookie = cookies[i];\n        var eqPos = cookie.indexOf(\"=\");\n        var name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;\n        document.cookie = name + \"=;expires=Thu, 01 Jan 1970 00:00:00 GMT\";\n    }\n  }\n \n  const push = async () => {\n\n    console.log('push!', carrito)  \n    if(carrito !== '' && carrito !== '{\\\"isOpen\\\":false,\\\"items\\\":[],\\\"isRestaurant\\\":false,\\\"coupon\\\":null}')\n    {\n      await insert_abandonado({\n        variables: { \n          clientid: config().SUBSCRIPTION_ID,\n          customerid: cookie.get('customer') && cookie.get('customer').id,\n          data_json: carrito\n        },\n      });  \n    }  \n  \n}\n\n  const put = async () => {\n    if(carrito !== '' && carrito !== '{\\\"isOpen\\\":false,\\\"items\\\":[],\\\"isRestaurant\\\":false,\\\"coupon\\\":null}')\n    {\n      await upgrade_abandonado({\n        variables: { \n          \"clientid\": config().SUBSCRIPTION_ID,\n          \"customerid\": cookie.get('customer') && cookie.get('customer').id,\n          \"data_json\": carrito\n        },\n      });  \n   } \n  }\n\n   \n\n  const handleLogout = async () => { \n  \n\n     if ( data && data.carritos_abandonados && data.carritos_abandonados.length > 0 ) {\n        await put()\n     } \n     if ( data && data.carritos_abandonados && data.carritos_abandonados.length === 0 ) {\n        await push()\n     }  \n     \n      await cookie.remove('access_token');\n      await cookie.remove('customer'); \n      await cookie.remove('user_logged'); \n      localForage.removeItem('@session');\n      await deleteAllCookies(); \n      await clearCart(); \n      authDispatch({ type: 'SIGN_OUT' });\n      Router.push('/grocery');\n  };\n\n  return (\n    <>\n      {AUTHORIZED_MENU_ITEMS.map((item, idx) => (\n        <NavLink\n          key={idx}\n          className='menu-item'\n          href={item.href}\n          label={item.defaultMessage}\n          intlId={item.id}\n        />\n      ))}\n      <div className='menu-item' onClick={handleLogout}>\n        <a>\n          <span>\n            <FormattedMessage id='nav.logout' defaultMessage='Logout' />\n          </span>\n        </a>\n      </div>\n    </>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}