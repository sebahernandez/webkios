{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"/Users/alejandrosandoval/space/world_eserp/web/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/alejandrosandoval/space/world_eserp/web/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/alejandrosandoval/space/world_eserp/web/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"/Users/alejandrosandoval/space/world_eserp/web/packages/shop-restaurant/src/layouts/header/mobile-drawer.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { useContext } from 'react';\nimport { openModal } from '@redq/reuse-modal';\nimport Router from 'next/router';\nimport { FormattedMessage } from 'react-intl';\nimport { Scrollbar } from 'components/scrollbar/scrollbar';\nimport Drawer from 'components/drawer/drawer';\nimport { Button } from 'components/button/button';\nimport NavLink from 'components/nav-link/nav-link';\nimport { CloseIcon } from 'assets/icons/CloseIcon';\nimport { AuthContext } from 'contexts/auth/auth.context';\nimport AuthenticationForm from 'features/authentication-form';\nimport Cookies from 'universal-cookie';\nimport localForage from 'localforage';\nimport config from 'setting/config';\nimport { DrawerBody, HamburgerIcon, DrawerContentWrapper, DrawerClose, DrawerProfile, LogoutView, LoginView, UserAvatar, UserDetails, DrawerMenu, DrawerMenuItem, UserOptionMenu } from './header.style';\nimport { MOBILE_DRAWER_MENU, MOBILE_AUTHORIZED_DRAWER_MENU, PROFILE_PAGE } from 'site-settings/site-navigation';\nimport { useAppState, useAppDispatch } from 'contexts/app/app.provider';\nimport { useMutation, useQuery } from '@apollo/client';\nimport { GET_ABANDONADOS } from 'utils/graphql/query/abandonados.query';\nimport { AGREGAR_ABANDONADO } from 'utils/graphql/mutation/abandonados';\nimport { UPGRADE_ABANDONADO } from 'utils/graphql/mutation/abandonados';\n\nvar MobileDrawer = function MobileDrawer() {\n  _s();\n\n  var isDrawerOpen = useAppState('isDrawerOpen');\n  var dispatch = useAppDispatch();\n  var cookie = new Cookies();\n  var image = '/user.jpg';\n  var nombre = 'Invitado';\n  var user = null;\n  var access_token = null;\n  var carrito = localForage.getItem('@session');\n\n  var _useMutation = useMutation(AGREGAR_ABANDONADO),\n      _useMutation2 = _slicedToArray(_useMutation, 1),\n      insert_abandonado = _useMutation2[0];\n\n  var _useMutation3 = useMutation(UPGRADE_ABANDONADO),\n      _useMutation4 = _slicedToArray(_useMutation3, 1),\n      upgrade_abandonado = _useMutation4[0];\n\n  var _useQuery = useQuery(GET_ABANDONADOS, {\n    variables: {\n      clientid: config().SUBSCRIPTION_ID,\n      customerid: cookie.get('customer') && cookie.get('customer').id\n    }\n  }),\n      data = _useQuery.data;\n\n  var _useContext = useContext(AuthContext),\n      isAuthenticated = _useContext.authState.isAuthenticated,\n      authDispatch = _useContext.authDispatch; // Toggle drawer\n\n\n  var toggleHandler = React.useCallback(function () {\n    dispatch({\n      type: 'TOGGLE_DRAWER'\n    });\n  }, [dispatch]);\n\n  var push = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return insert_abandonado({\n                variables: {\n                  clientid: config().SUBSCRIPTION_ID,\n                  customerid: cookie.get('customer') && cookie.get('customer').id,\n                  data_json: '{}'\n                }\n              });\n\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function push() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var put = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return upgrade_abandonado({\n                variables: {\n                  \"clientid\": config().SUBSCRIPTION_ID,\n                  \"customerid\": cookie.get('customer') && cookie.get('customer').id,\n                  \"data_json\": carrito\n                }\n              });\n\n            case 2:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function put() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var displayLog = function displayLog() {\n    console.log('0101:::::::::::::::::::');\n    console.log('0101:::::::::::::::::::', 'data', data);\n    console.log('0101:::::::::::::::::::', 'customerid', cookie.get('customer').id);\n    console.log('0101:::::::::::::::::::', 'json_data', carrito);\n    console.log('0101:::::::::::::::::::');\n  };\n\n  var handleLogout = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              if (!true) {\n                _context3.next = 14;\n                break;\n              }\n\n              displayLog();\n\n              if (!(data.carritos_abandonados && data.carritos_abandonados.length > 0)) {\n                _context3.next = 7;\n                break;\n              }\n\n              _context3.next = 5;\n              return put();\n\n            case 5:\n              _context3.next = 9;\n              break;\n\n            case 7:\n              _context3.next = 9;\n              return push();\n\n            case 9:\n              cookie.remove('access_token');\n              cookie.remove('customer');\n              cookie.remove('user_logged');\n              authDispatch({\n                type: 'SIGN_OUT'\n              });\n              Router.push('/grocery');\n\n            case 14:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function handleLogout() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  if (isAuthenticated) {\n    if (cookie.get('user_logged')) {\n      user = cookie.get('user_logged');\n      access_token = cookie.get('access_token');\n\n      if (user && access_token) {\n        image = user.image;\n        nombre = user.name;\n      }\n    }\n  }\n\n  var signInOutForm = function signInOutForm() {\n    dispatch({\n      type: 'TOGGLE_DRAWER'\n    });\n    authDispatch({\n      type: 'SIGNIN'\n    });\n    cookie.set('login', 1);\n    openModal({\n      show: true,\n      overlayClassName: 'quick-view-overlay',\n      closeOnClickOutside: true,\n      component: AuthenticationForm,\n      closeComponent: '',\n      config: {\n        enableResizing: false,\n        disableDragging: true,\n        className: 'quick-view-modal',\n        width: 458,\n        height: 'auto'\n      }\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(Drawer, {\n    width: \"316px\",\n    drawerHandler: /*#__PURE__*/_jsxDEV(HamburgerIcon, {\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 11\n      }, _this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 11\n      }, _this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 11\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 9\n    }, _this),\n    open: isDrawerOpen,\n    toggleHandler: toggleHandler,\n    closeButton: /*#__PURE__*/_jsxDEV(DrawerClose, {\n      children: /*#__PURE__*/_jsxDEV(CloseIcon, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 11\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 9\n    }, _this),\n    children: /*#__PURE__*/_jsxDEV(DrawerBody, {\n      children: /*#__PURE__*/_jsxDEV(Scrollbar, {\n        className: \"drawer-scrollbar\",\n        children: /*#__PURE__*/_jsxDEV(DrawerContentWrapper, {\n          children: [/*#__PURE__*/_jsxDEV(DrawerProfile, {\n            children: isAuthenticated ? /*#__PURE__*/_jsxDEV(LoginView, {\n              children: [/*#__PURE__*/_jsxDEV(UserAvatar, {\n                children: /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: image,\n                  alt: nombre\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 188,\n                  columnNumber: 23\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 187,\n                columnNumber: 19\n              }, _this), /*#__PURE__*/_jsxDEV(UserDetails, {\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  children: nombre\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 191,\n                  columnNumber: 21\n                }, _this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: cookie.get('customer') && cookie.get('customer').nombre\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 192,\n                  columnNumber: 21\n                }, _this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: cookie.get('customer') && cookie.get('customer').contacts && cookie.get('customer').contacts.length > 0 && cookie.get('customer').contacts[0].number\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 193,\n                  columnNumber: 21\n                }, _this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 190,\n                columnNumber: 19\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 186,\n              columnNumber: 17\n            }, _this) : /*#__PURE__*/_jsxDEV(LogoutView, {\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                variant: \"primary\",\n                onClick: signInOutForm,\n                children: /*#__PURE__*/_jsxDEV(FormattedMessage, {\n                  id: \"mobileSignInButtonText\",\n                  defaultMessage: \"join\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 199,\n                  columnNumber: 21\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 198,\n                columnNumber: 19\n              }, _this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 197,\n              columnNumber: 17\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(DrawerMenu, {\n            children: [isAuthenticated && MOBILE_AUTHORIZED_DRAWER_MENU.map(function (item) {\n              return /*#__PURE__*/_jsxDEV(DrawerMenuItem, {\n                children: /*#__PURE__*/_jsxDEV(NavLink, {\n                  onClick: toggleHandler,\n                  href: item.href,\n                  label: item.defaultMessage,\n                  intlId: item.id,\n                  className: \"drawer_menu_item\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 211,\n                  columnNumber: 19\n                }, _this)\n              }, item.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 210,\n                columnNumber: 17\n              }, _this);\n            }), !isAuthenticated && MOBILE_DRAWER_MENU.map(function (item) {\n              return /*#__PURE__*/_jsxDEV(DrawerMenuItem, {\n                children: /*#__PURE__*/_jsxDEV(NavLink, {\n                  onClick: toggleHandler,\n                  href: item.href,\n                  label: item.defaultMessage,\n                  intlId: item.id,\n                  className: \"drawer_menu_item\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 222,\n                  columnNumber: 19\n                }, _this)\n              }, item.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 221,\n                columnNumber: 17\n              }, _this);\n            })]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 13\n          }, _this), isAuthenticated && /*#__PURE__*/_jsxDEV(UserOptionMenu, {\n            children: [/*#__PURE__*/_jsxDEV(DrawerMenuItem, {\n              children: /*#__PURE__*/_jsxDEV(NavLink, {\n                href: PROFILE_PAGE,\n                label: \"Configuraci\\xF3n de mi cuenta\",\n                className: \"drawer_menu_item\",\n                intlId: \"navlinkAccountSettings\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 236,\n                columnNumber: 19\n              }, _this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 235,\n              columnNumber: 17\n            }, _this), /*#__PURE__*/_jsxDEV(DrawerMenuItem, {\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                onClick: handleLogout,\n                className: \"drawer_menu_item\",\n                children: /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"logoutBtn\",\n                  children: /*#__PURE__*/_jsxDEV(FormattedMessage, {\n                    id: \"navlinkLogout\",\n                    defaultMessage: \"Cerrar sesi\\xF3n\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 246,\n                    columnNumber: 23\n                  }, _this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 245,\n                  columnNumber: 21\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 244,\n                columnNumber: 19\n              }, _this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 243,\n              columnNumber: 17\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 234,\n            columnNumber: 15\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 11\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 7\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 164,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(MobileDrawer, \"CSXAun8TqkBRCSP8rIMNFS4ZWH4=\", false, function () {\n  return [useAppState, useAppDispatch, useMutation, useMutation, useQuery];\n});\n\n_c = MobileDrawer;\nexport default MobileDrawer;\n\nvar _c;\n\n$RefreshReg$(_c, \"MobileDrawer\");","map":{"version":3,"sources":["/Users/alejandrosandoval/space/world_eserp/web/packages/shop-restaurant/src/layouts/header/mobile-drawer.tsx"],"names":["React","useContext","openModal","Router","FormattedMessage","Scrollbar","Drawer","Button","NavLink","CloseIcon","AuthContext","AuthenticationForm","Cookies","localForage","config","DrawerBody","HamburgerIcon","DrawerContentWrapper","DrawerClose","DrawerProfile","LogoutView","LoginView","UserAvatar","UserDetails","DrawerMenu","DrawerMenuItem","UserOptionMenu","MOBILE_DRAWER_MENU","MOBILE_AUTHORIZED_DRAWER_MENU","PROFILE_PAGE","useAppState","useAppDispatch","useMutation","useQuery","GET_ABANDONADOS","AGREGAR_ABANDONADO","UPGRADE_ABANDONADO","MobileDrawer","isDrawerOpen","dispatch","cookie","image","nombre","user","access_token","carrito","getItem","insert_abandonado","upgrade_abandonado","variables","clientid","SUBSCRIPTION_ID","customerid","get","id","data","isAuthenticated","authState","authDispatch","toggleHandler","useCallback","type","push","data_json","put","displayLog","console","log","handleLogout","carritos_abandonados","length","remove","name","signInOutForm","set","show","overlayClassName","closeOnClickOutside","component","closeComponent","enableResizing","disableDragging","className","width","height","contacts","number","map","item","href","defaultMessage"],"mappings":"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","sourcesContent":["import React, { useContext } from 'react';\nimport { openModal } from '@redq/reuse-modal';\nimport Router from 'next/router';\nimport { FormattedMessage } from 'react-intl';\nimport { Scrollbar } from 'components/scrollbar/scrollbar';\nimport Drawer from 'components/drawer/drawer';\nimport { Button } from 'components/button/button';\nimport NavLink from 'components/nav-link/nav-link';\nimport { CloseIcon } from 'assets/icons/CloseIcon';\nimport { AuthContext } from 'contexts/auth/auth.context';\nimport AuthenticationForm from 'features/authentication-form';\nimport Cookies  from 'universal-cookie';\nimport localForage from 'localforage';\nimport config from 'setting/config';\n\nimport {\n  DrawerBody,\n  HamburgerIcon,\n  DrawerContentWrapper,\n  DrawerClose,\n  DrawerProfile,\n  LogoutView,\n  LoginView,\n  UserAvatar,\n  UserDetails,\n  DrawerMenu,\n  DrawerMenuItem,\n  UserOptionMenu,\n} from './header.style';\nimport UserImage from 'assets/images/user.jpg';\nimport {\n  MOBILE_DRAWER_MENU,\n  MOBILE_AUTHORIZED_DRAWER_MENU,\n  PROFILE_PAGE,\n  YOUR_ORDER_PAGE,\n} from 'site-settings/site-navigation';\nimport { useAppState, useAppDispatch } from 'contexts/app/app.provider';\nimport { useMutation, useQuery } from '@apollo/client';\nimport { GET_ABANDONADOS } from 'utils/graphql/query/abandonados.query';\nimport { AGREGAR_ABANDONADO } from 'utils/graphql/mutation/abandonados';\nimport { UPGRADE_ABANDONADO } from 'utils/graphql/mutation/abandonados';\n\n\nconst MobileDrawer: React.FunctionComponent = () => {\n  const isDrawerOpen = useAppState('isDrawerOpen');\n  const dispatch = useAppDispatch();\n  const cookie = new Cookies()\n  let image='/user.jpg';\n  let nombre='Invitado';\n  let user = null\n  let access_token  = null\n  const carrito = localForage.getItem('@session');\n  const [insert_abandonado] = useMutation(AGREGAR_ABANDONADO); \n  const [upgrade_abandonado] = useMutation(UPGRADE_ABANDONADO); \n\n  const { data } = useQuery(\n    GET_ABANDONADOS,\n    {\n      variables: { \n        clientid: config().SUBSCRIPTION_ID,\n        customerid: cookie.get('customer') &&  cookie.get('customer').id\n      }\n    }\n  );\n\n  const {\n    authState: { isAuthenticated },\n    authDispatch,\n  } = useContext<any>(AuthContext);\n  // Toggle drawer\n  const toggleHandler = React.useCallback(() => {\n    dispatch({\n      type: 'TOGGLE_DRAWER',\n    });\n  }, [dispatch]);\n \n   const push = async () => {\n    await insert_abandonado({\n      variables: { \n        clientid: config().SUBSCRIPTION_ID,\n        customerid: cookie.get('customer') && cookie.get('customer').id,\n        data_json: '{}'\n      },\n  });  \n  }\n\n  const put = async () => {\n    await upgrade_abandonado({\n      variables: { \n        \"clientid\": config().SUBSCRIPTION_ID,\n        \"customerid\": cookie.get('customer') && cookie.get('customer').id,\n        \"data_json\": carrito\n      },\n  });  \n  }\n\n  const displayLog = () =>{ \n     console.log('0101:::::::::::::::::::')\n     console.log('0101:::::::::::::::::::','data',data )\n     console.log('0101:::::::::::::::::::','customerid',cookie.get('customer').id )\n     console.log('0101:::::::::::::::::::','json_data',carrito )\n     console.log('0101:::::::::::::::::::')\n  }\n\n\n  const handleLogout = async () => {\n     \n    if (typeof window !== 'undefined') {\n      \n    displayLog()\n\n     if ( data.carritos_abandonados && data.carritos_abandonados.length > 0 ) {\n        await put()\n     } else { \n        await push()\n     }  \n      cookie.remove('access_token');\n      cookie.remove('customer');\n      cookie.remove('user_logged');\n      authDispatch({ type: 'SIGN_OUT' });\n      Router.push('/grocery');\n    }\n  };\n\n  if(isAuthenticated){\n    if( cookie.get('user_logged') ){\n      user = cookie.get('user_logged')\n      access_token = cookie.get('access_token')\n\n      if(user && access_token)  {\n          image =   user.image;\n          nombre = user.name; \n      }\n    }\n  }\n   \n\n  const signInOutForm = () => {\n    dispatch({\n      type: 'TOGGLE_DRAWER',\n    });\n\n    authDispatch({\n      type: 'SIGNIN',\n    });\n    cookie.set('login',1)\n    openModal({\n      show: true,\n      overlayClassName: 'quick-view-overlay',\n      closeOnClickOutside: true,\n      component: AuthenticationForm,\n      closeComponent: '',\n      config: {\n        enableResizing: false,\n        disableDragging: true,\n        className: 'quick-view-modal',\n        width: 458,\n        height: 'auto',\n      },\n    });\n  };\n\n  return (\n    <Drawer\n      width='316px'\n      drawerHandler={\n        <HamburgerIcon>\n          <span />\n          <span />\n          <span />\n        </HamburgerIcon>\n      }\n      open={isDrawerOpen}\n      toggleHandler={toggleHandler}\n      closeButton={\n        <DrawerClose>\n          <CloseIcon />\n        </DrawerClose>\n      }\n    >\n      <DrawerBody>\n        <Scrollbar className='drawer-scrollbar'>\n          <DrawerContentWrapper>\n            <DrawerProfile>\n              {isAuthenticated ? (\n                <LoginView>\n                  <UserAvatar>\n                      <img src={image} alt={nombre} />\n                  </UserAvatar>\n                  <UserDetails>\n                    <h3>{nombre}</h3>\n                    <span>{cookie.get('customer') && cookie.get('customer').nombre}</span>\n                    <span>{cookie.get('customer') && cookie.get('customer').contacts && cookie.get('customer').contacts.length > 0 && cookie.get('customer').contacts[0].number}</span>\n                  </UserDetails>\n                </LoginView>\n              ) : (\n                <LogoutView>\n                  <Button variant='primary' onClick={signInOutForm}>\n                    <FormattedMessage\n                      id='mobileSignInButtonText'\n                      defaultMessage='join'\n                    />\n                  </Button>\n                </LogoutView>\n              )}\n            </DrawerProfile>\n\n            <DrawerMenu>\n              {isAuthenticated && MOBILE_AUTHORIZED_DRAWER_MENU.map((item) => (\n                <DrawerMenuItem key={item.id}>\n                  <NavLink\n                    onClick={toggleHandler}\n                    href={item.href}\n                    label={item.defaultMessage}\n                    intlId={item.id}\n                    className='drawer_menu_item'\n                  />\n                </DrawerMenuItem>\n              ))}\n               {!isAuthenticated && MOBILE_DRAWER_MENU.map((item) => (\n                <DrawerMenuItem key={item.id}>\n                  <NavLink\n                    onClick={toggleHandler}\n                    href={item.href}\n                    label={item.defaultMessage}\n                    intlId={item.id}\n                    className='drawer_menu_item'\n                  />\n                </DrawerMenuItem>\n              ))}\n            </DrawerMenu>\n\n            {isAuthenticated && (\n              <UserOptionMenu>\n                <DrawerMenuItem>\n                  <NavLink\n                    href={PROFILE_PAGE}\n                    label='Configuración de mi cuenta'\n                    className='drawer_menu_item'\n                    intlId='navlinkAccountSettings'\n                  />\n                </DrawerMenuItem>\n                <DrawerMenuItem>\n                  <div onClick={handleLogout} className='drawer_menu_item'>\n                    <span className='logoutBtn'>\n                      <FormattedMessage\n                        id='navlinkLogout'\n                        defaultMessage='Cerrar sesión'\n                      />\n                    </span>\n                  </div>\n                </DrawerMenuItem>\n              </UserOptionMenu>\n            )}\n          </DrawerContentWrapper>\n        </Scrollbar>\n      </DrawerBody>\n    </Drawer>\n  );\n};\n\nexport default MobileDrawer;\n"]},"metadata":{},"sourceType":"module"}