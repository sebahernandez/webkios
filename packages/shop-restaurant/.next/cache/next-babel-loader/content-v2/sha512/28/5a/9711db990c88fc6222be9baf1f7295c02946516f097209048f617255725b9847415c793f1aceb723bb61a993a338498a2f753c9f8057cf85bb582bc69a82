{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport _defineProperty from \"/Users/sebastian/space/web/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"/Users/sebastian/space/web/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/sebastian/space/web/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/sebastian/space/web/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"/Users/sebastian/space/web/node_modules/next/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\n\nvar _jsxFileName = \"/Users/sebastian/space/web/packages/shop-restaurant/src/features/coupon/coupon.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState } from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { CouponBoxWrapper, Error } from './coupon.style';\nimport { Input } from 'components/forms/input';\nimport { Button } from 'components/button/button';\nimport { useCart } from 'contexts/cart/use-cart';\nimport { useMutation } from '@apollo/client';\nimport { APPLY_COUPON } from 'graphql/mutation/coupon';\n\nvar Coupon = function Coupon(_ref) {\n  _s();\n\n  var disabled = _ref.disabled,\n      className = _ref.className,\n      style = _ref.style,\n      _ref$errorMsgFixed = _ref.errorMsgFixed,\n      errorMsgFixed = _ref$errorMsgFixed === void 0 ? false : _ref$errorMsgFixed,\n      props = _objectWithoutProperties(_ref, [\"disabled\", \"className\", \"style\", \"errorMsgFixed\"]);\n\n  var intl = useIntl();\n\n  var _useCart = useCart(),\n      applyCoupon = _useCart.applyCoupon;\n\n  var _useState = useState(''),\n      code = _useState[0],\n      setCode = _useState[1];\n\n  var _useState2 = useState(null),\n      error = _useState2[0],\n      setError = _useState2[1];\n\n  var _useMutation = useMutation(APPLY_COUPON),\n      _useMutation2 = _slicedToArray(_useMutation, 1),\n      appliedCoupon = _useMutation2[0];\n\n  var handleApplyCoupon = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _yield$appliedCoupon, data;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return appliedCoupon({\n                variables: {\n                  code: code\n                }\n              });\n\n            case 2:\n              _yield$appliedCoupon = _context.sent;\n              data = _yield$appliedCoupon.data;\n\n              if (data.applyCoupon && data.applyCoupon.discountInPercent) {\n                setError('');\n                applyCoupon(data.applyCoupon);\n                setCode('');\n              } else {\n                setError('Invalid Coupon');\n              }\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleApplyCoupon() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handleOnChange = function handleOnChange(e) {\n    setCode(e.currentTarget.value);\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(CouponBoxWrapper, {\n      className: className ? className : 'boxedCoupon',\n      style: style,\n      children: [/*#__PURE__*/_jsxDEV(Input, _objectSpread({\n        onChange: handleOnChange,\n        value: code,\n        placeholder: intl.formatMessage({\n          id: 'couponPlaceholder',\n          defaultMessage: 'Ingresar Cupón Aquí'\n        })\n      }, props), void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(Button, {\n        type: \"button\",\n        onClick: handleApplyCoupon,\n        disabled: disabled,\n        padding: \"0 30px\",\n        children: /*#__PURE__*/_jsxDEV(FormattedMessage, {\n          id: \"voucherApply\",\n          defaultMessage: \"Apply\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 11\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 7\n    }, _this), error && /*#__PURE__*/_jsxDEV(Error, {\n      errorMsgFixed: errorMsgFixed,\n      children: /*#__PURE__*/_jsxDEV(FormattedMessage, {\n        id: \"couponError\",\n        defaultMessage: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 11\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 9\n    }, _this)]\n  }, void 0, true);\n};\n\n_s(Coupon, \"K/eaDyWCiOHJCcfGf1R0+A2frLc=\", false, function () {\n  return [useIntl, useCart, useMutation];\n});\n\n_c = Coupon;\nexport default Coupon;\n\nvar _c;\n\n$RefreshReg$(_c, \"Coupon\");","map":{"version":3,"sources":["/Users/sebastian/space/web/packages/shop-restaurant/src/features/coupon/coupon.tsx"],"names":["React","useState","FormattedMessage","useIntl","CouponBoxWrapper","Error","Input","Button","useCart","useMutation","APPLY_COUPON","Coupon","disabled","className","style","errorMsgFixed","props","intl","applyCoupon","code","setCode","error","setError","appliedCoupon","handleApplyCoupon","variables","data","discountInPercent","handleOnChange","e","currentTarget","value","formatMessage","id","defaultMessage"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { CouponBoxWrapper, Error } from './coupon.style';\nimport { Input } from 'components/forms/input';\nimport { Button } from 'components/button/button';\nimport { useCart } from 'contexts/cart/use-cart';\nimport { useMutation } from '@apollo/client';\nimport { APPLY_COUPON } from 'graphql/mutation/coupon';\n\ntype CouponProps = {\n  disabled?: any;\n  className?: string;\n  style?: any;\n  errorMsgFixed?: boolean;\n};\n\nconst Coupon: React.FC<CouponProps> = ({\n  disabled,\n  className,\n  style,\n  errorMsgFixed = false,\n  ...props\n}) => {\n  const intl = useIntl();\n  const { applyCoupon } = useCart();\n  const [code, setCode] = useState('');\n  const [error, setError] = useState(null);\n  const [appliedCoupon] = useMutation(APPLY_COUPON);\n\n  const handleApplyCoupon = async () => {\n    const { data }: any = await appliedCoupon({\n      variables: { code },\n    });\n    if (data.applyCoupon && data.applyCoupon.discountInPercent) {\n      setError('');\n      applyCoupon(data.applyCoupon);\n      setCode('');\n    } else {\n      setError('Invalid Coupon');\n    }\n  };\n  const handleOnChange: React.ChangeEventHandler<HTMLInputElement> = (e) => {\n    setCode(e.currentTarget.value);\n  };\n  return (\n    <>\n      <CouponBoxWrapper\n        className={className ? className : 'boxedCoupon'}\n        style={style}\n      >\n        <Input\n          onChange={handleOnChange}\n          value={code}\n          placeholder={intl.formatMessage({\n            id: 'couponPlaceholder',\n            defaultMessage: 'Ingresar Cupón Aquí',\n          })}\n          {...props}\n        />\n        <Button\n          type='button'\n          onClick={handleApplyCoupon}\n          disabled={disabled}\n          padding='0 30px'\n        >\n          <FormattedMessage id='voucherApply' defaultMessage='Apply' />\n        </Button>\n      </CouponBoxWrapper>\n      {error && (\n        <Error errorMsgFixed={errorMsgFixed}>\n          <FormattedMessage id='couponError' defaultMessage={error} />\n        </Error>\n      )}\n    </>\n  );\n};\n\nexport default Coupon;\n"]},"metadata":{},"sourceType":"module"}