{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport _defineProperty from \"/Users/alejandrosandoval/space/world_eserp/web/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"/Users/alejandrosandoval/space/world_eserp/web/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/alejandrosandoval/space/world_eserp/web/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/alejandrosandoval/space/world_eserp/web/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"/Users/alejandrosandoval/space/world_eserp/web/node_modules/next/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState } from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { CouponBoxWrapper, Error } from './coupon.style';\nimport { Input } from 'components/forms/input';\nimport { Button } from 'components/button/button';\nimport { useCart } from 'contexts/cart/use-cart';\nimport { useMutation } from '@apollo/client';\nimport { APPLY_COUPON } from 'graphql/mutation/coupon';\n\nvar Coupon = function Coupon(_ref) {\n  var disabled = _ref.disabled,\n      className = _ref.className,\n      style = _ref.style,\n      _ref$errorMsgFixed = _ref.errorMsgFixed,\n      errorMsgFixed = _ref$errorMsgFixed === void 0 ? false : _ref$errorMsgFixed,\n      props = _objectWithoutProperties(_ref, [\"disabled\", \"className\", \"style\", \"errorMsgFixed\"]);\n\n  var intl = useIntl();\n\n  var _useCart = useCart(),\n      applyCoupon = _useCart.applyCoupon;\n\n  var _useState = useState(''),\n      code = _useState[0],\n      setCode = _useState[1];\n\n  var _useState2 = useState(null),\n      error = _useState2[0],\n      setError = _useState2[1];\n\n  var _useMutation = useMutation(APPLY_COUPON),\n      _useMutation2 = _slicedToArray(_useMutation, 1),\n      appliedCoupon = _useMutation2[0];\n\n  var handleApplyCoupon = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _yield$appliedCoupon, data;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return appliedCoupon({\n                variables: {\n                  code: code\n                }\n              });\n\n            case 2:\n              _yield$appliedCoupon = _context.sent;\n              data = _yield$appliedCoupon.data;\n\n              if (data.applyCoupon && data.applyCoupon.discountInPercent) {\n                setError('');\n                applyCoupon(data.applyCoupon);\n                setCode('');\n              } else {\n                setError('Invalid Coupon');\n              }\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleApplyCoupon() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handleOnChange = function handleOnChange(e) {\n    setCode(e.currentTarget.value);\n  };\n\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsxs(CouponBoxWrapper, {\n      className: className ? className : 'boxedCoupon',\n      style: style,\n      children: [/*#__PURE__*/_jsx(Input, _objectSpread({\n        onChange: handleOnChange,\n        value: code,\n        placeholder: intl.formatMessage({\n          id: 'couponPlaceholder',\n          defaultMessage: 'Ingresar Cupón Aquí'\n        })\n      }, props)), /*#__PURE__*/_jsx(Button, {\n        type: \"button\",\n        onClick: handleApplyCoupon,\n        disabled: disabled,\n        padding: \"0 30px\",\n        children: /*#__PURE__*/_jsx(FormattedMessage, {\n          id: \"voucherApply\",\n          defaultMessage: \"Apply\"\n        })\n      })]\n    }), error && /*#__PURE__*/_jsx(Error, {\n      errorMsgFixed: errorMsgFixed,\n      children: /*#__PURE__*/_jsx(FormattedMessage, {\n        id: \"couponError\",\n        defaultMessage: error\n      })\n    })]\n  });\n};\n\nexport default Coupon;","map":null,"metadata":{},"sourceType":"module"}